<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Language Switcher (EN/FR)</title>
  <style>
    /* =====================
       Language Switcher CSS
       ===================== */
    :root{
      --ls-bg: #0b0f19;          /* dropdown list background */
      --ls-surface: #121726;     /* trigger background */
      --ls-ring: #3B82F6;        /* focus ring */
      --ls-fg: #ffffff;          /* primary text */
      --ls-dim: #cbd5e1;         /* dim text */
      --ls-hover: #2563eb;       /* hover/selected */
      --ls-border: #1f2937;      /* subtle border */
      --ls-shadow: 0 10px 30px rgba(2,6,23,.45);
      --radius: 12px;
    }

    /* Custom menu */
    .lang-menu{ position:relative; display:inline-block; isolation:isolate; z-index:30; }
    .lang-menu .trigger{
      background: var(--ls-surface);
      color: var(--ls-fg);
      border: 2px solid var(--ls-ring);
      border-radius: 999px;
      padding: .5rem 2rem .5rem .875rem;
      font-weight: 800; line-height:1; cursor:pointer;
    }
    .lang-menu .trigger:focus{ outline:none; box-shadow:0 0 0 3px color-mix(in oklab, var(--ls-ring) 40%, transparent); }
    .lang-menu .trigger:after{ content:"\25BE"; position:absolute; right:.75rem; top:50%; translate:0 -48%; pointer-events:none; opacity:.9; }

    .lang-menu .list{ position:absolute; right:0; top:calc(100% + 6px); min-width:8rem; background:var(--ls-bg); color:var(--ls-fg);
      border:1px solid var(--ls-border); border-radius:.5rem; padding:6px 0; margin:0; list-style:none; box-shadow:var(--ls-shadow); display:none; }
    .lang-menu.open .list{ display:block; }

    .lang-menu .item{ padding:.5rem .875rem; white-space:nowrap; cursor:pointer; }
    .lang-menu .item:hover, .lang-menu .item[aria-selected="true"]{ background:var(--ls-hover); color:#fff; }
    .lang-menu .item[aria-disabled="true"]{ opacity:1; color:var(--ls-dim); pointer-events:auto; }

    /* Native <select> fallback */
    .lang-select{ appearance:none; background:var(--ls-surface); color:var(--ls-fg); border:2px solid var(--ls-ring); border-radius:999px; padding:.5rem 2rem .5rem .875rem; font-weight:800; line-height:1; }
    .lang-select option{ background:var(--ls-bg) !important; color:var(--ls-fg) !important; }
    .lang-select option:hover, .lang-select option:checked{ background:var(--ls-hover) !important; color:#fff !important; }

    /* Demo layout */
    body{ margin:0; font-family:Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif; color:#e5e7eb; background:linear-gradient(180deg,#0b0f19,#0b0f19 40%,#101828); }
    header{ padding:24px; display:flex; justify-content:flex-end; }
    main{ max-width:920px; margin:0 auto; padding:24px; }
    h1{ color:#fff; margin:.5rem 0; }
    p{ color:#cbd5e1; }
    .card{ background:#0f172a; border:1px solid #1f2937; border-radius:var(--radius); padding:20px; }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
  </style>
</head>
<body>
  <header>
    <!-- Custom menu switcher -->
    <div class="lang-menu" id="langMenu">
      <button class="trigger" id="langTrigger" aria-haspopup="listbox" aria-expanded="false" aria-label="Change language">EN</button>
      <ul class="list" id="langList" role="listbox" aria-labelledby="langTrigger">
        <li class="item" role="option" data-value="en" aria-selected="true">EN</li>
        <li class="item" role="option" data-value="fr">FR</li>
      </ul>
    </div>

    <!-- Native select fallback (hidden by default; show if you prefer) -->
    <!-- <select class="lang-select" id="langSelect" aria-label="Change language">
      <option value="en">EN</option>
      <option value="fr">FR</option>
    </select> -->
  </header>

  <main>
    <div class="card">
      <h1 data-i18n="title" data-en="Vote for Progress — Vieux‑Saint‑Hubert–La Savane" data-fr="Votez pour le progrès — Vieux‑Saint‑Hubert–La Savane">Vote for Progress — Vieux‑Saint‑Hubert–La Savane</h1>
      <p data-i18n="subtitle" data-en="Building a healthier, greener, more connected community — together." data-fr="Bâtissons une communauté plus saine, plus verte et mieux connectée — ensemble.">Building a healthier, greener, more connected community — together.</p>
      <p data-i18n="cta" data-en="Your voice matters. Join the campaign and help shape our district." data-fr="Votre voix compte. Rejoignez la campagne et contribuez à façonner notre district.">Your voice matters. Join the campaign and help shape our district.</p>
      <a href="#" id="voteBtn" class="btn" style="display:inline-block;margin-top:10px;background:#2563eb;color:#fff;padding:10px 16px;border-radius:10px;text-decoration:none;font-weight:700;">Vote</a>
    </div>
  </main>

  <script>
    // =====================
    // Language Switcher JS
    // =====================
    (function(){
      const STORAGE_KEY = 'site.lang';
      const supported = ['en','fr'];

      const $menu = document.getElementById('langMenu');
      const $trigger = document.getElementById('langTrigger');
      const $list = document.getElementById('langList');

      function getInitialLang(){
        const u = new URL(String(location));
        const urlParam = (u.searchParams.get('lang')||'').toLowerCase();
        if (supported.includes(urlParam)) return urlParam;
        const saved = (localStorage.getItem(STORAGE_KEY)||'').toLowerCase();
        if (supported.includes(saved)) return saved;
        const n = navigator.language || navigator.userLanguage || 'en';
        return n.toLowerCase().startsWith('fr') ? 'fr' : 'en';
      }

      function setLang(lang, {persist=true, updateURL=false}={}){
        if (!supported.includes(lang)) lang = 'en';
        document.documentElement.lang = lang;
        // UI text swap
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const txt = el.getAttribute(`data-${lang}`);
          if (txt) el.textContent = txt;
        });
        // Trigger label and selection state
        $trigger.textContent = lang.toUpperCase();
        $list.querySelectorAll('[role="option"]').forEach(li => li.setAttribute('aria-selected', String(li.dataset.value===lang)));
        if (persist) localStorage.setItem(STORAGE_KEY, lang);
        if (updateURL) {
          const url = new URL(location);
          url.searchParams.set('lang', lang);
          history.replaceState({}, '', url);
        }
        // Optional: announce change for screen readers
        const alert = document.createElement('div');
        alert.className = 'sr-only';
        alert.setAttribute('role','status');
        alert.textContent = (lang==='fr') ? 'Langue changée en français' : 'Language changed to English';
        document.body.appendChild(alert);
        setTimeout(()=>alert.remove(), 500);
      }

      // Open/close behavior
      function openMenu(){ $menu.classList.add('open'); $trigger.setAttribute('aria-expanded','true'); }
      function closeMenu(){ $menu.classList.remove('open'); $trigger.setAttribute('aria-expanded','false'); }

      $trigger.addEventListener('click', e => {
        e.stopPropagation();
        ($menu.classList.contains('open') ? closeMenu : openMenu)();
      });
      document.addEventListener('click', closeMenu);
      document.addEventListener('keydown', e => { if (e.key==='Escape') closeMenu(); });

      // Click items
      $list.addEventListener('click', e => {
        const li = e.target.closest('.item');
        if (!li) return;
        const lang = li.dataset.value;
        setLang(lang, {persist:true, updateURL:true});
        closeMenu();
      });

      // Initialize
      setLang(getInitialLang(), {persist:false, updateURL:false});
    })();
  </script>
</body>
</html>
